@model AnswerTicketViewModel
@using Microsoft.AspNetCore.Identity
@using ProjectWeb.Domain.Models
@inject UserManager<UserApp> _userManager

@{
    ViewData["Title"] = "TicketAnswer";
    Layout = "~/Views/Shared/_Layout_Admin.cshtml";
}

@{
    var user = await _userManager.FindByIdAsync(Model.Ticket.UserId);
    <div data-aos="fade-down" data-aos-duration="1000">
        <p>
            <i class="fas fa-file-signature"></i>
            <span class="font-weight-bold">عنوان تیکت :</span>
            <a asp-controller="Ticket" asp-action="TicketInfo" asp-route-id="@Model.Ticket.TicketId" class="text-hover">
                @Model.Ticket.TicketSubject
            </a>
        </p>
        <p>
            <div class="dropdown">
                <i class="far fa-user"></i>
                <span class="font-weight-bold">فرستنده : </span>
                <span class="dropdown-toggle text-hover" data-toggle="dropdown" style="cursor: pointer;">
                    @user.UserName
                </span>
                <div class="dropdown-menu dropdown-menu-right dropdown-no-m">
                    <p class="dropdown-item menu-text-hover">
                        <i class="far fa-user"></i>
                        @user.FirstName @user.LastName
                    </p>
                    <p class="dropdown-item menu-text-hover">
                        <i class="far fa-envelope"></i>
                        @user.Email
                    </p>
                    <p class="dropdown-item menu-text-hover">
                        <i class="fas fa-phone-alt"></i>
                        @user.PhoneNumber
                    </p>
                </div>
            </div>
        </p>
        <p class="small">
            <i class="fas fa-calendar-alt"></i>
            <span class="font-weight-bold">تاریخ ارسال :</span>
            @Model.Ticket.TicketDateTime
        </p>
        <hr />
        <div class="border p-3" style="border-radius: 10px;">
            <form asp-controller="Ticket" asp-action="TicketAnswer" method="post">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <div class="form-group">
                    <label asp-for="TicketAnswerDate"></label>
                    <input asp-for="TicketAnswerDate" class="form-control input-custom" readonly />
                </div>
                <div class="form-group">
                    <label asp-for="TicketAnswerText"></label>
                    <textarea asp-for="TicketAnswerText" id="my-textarea"></textarea>
                    <span asp-validation-for="TicketAnswerText" class="text-danger"></span>
                </div>
                <input asp-for="Ticket.TicketId" hidden/>
                <button type="submit" class="btn btn-ticket-answer-post">ارسال پاسخ</button>
            </form>
        </div>
    </div>
}

@section Scripts{
    @{ await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script src="/ckeditor/ckeditor.js"></script>
    <script src="/ckeditor/adapters/jquery.js"></script>
    <script>
        $(function () {
            $('#my-textarea').ckeditor();
        });
    </script>
}
